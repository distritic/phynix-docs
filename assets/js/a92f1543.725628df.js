"use strict";(self.webpackChunkphynix=self.webpackChunkphynix||[]).push([[964],{3905:function(e,n,t){t.d(n,{Zo:function(){return v},kt:function(){return d}});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=a.createContext({}),m=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},v=function(e){var n=m(e.components);return a.createElement(s.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,v=l(e,["components","mdxType","originalType","parentName"]),c=m(t),d=i,y=c["".concat(s,".").concat(d)]||c[d]||p[d]||r;return t?a.createElement(y,o(o({ref:n},v),{},{components:t})):a.createElement(y,o({ref:n},v))}));function d(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=c;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var m=2;m<r;m++)o[m]=t[m];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"},9284:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return v},default:function(){return c}});var a=t(7462),i=t(3366),r=(t(7294),t(3905)),o=["components"],l={},s="Events",m={unversionedId:"inventory/events",id:"inventory/events",isDocsHomePage:!1,title:"Events",description:"Server-side",source:"@site/docs/inventory/events.md",sourceDirName:"inventory",slug:"/inventory/events",permalink:"/docs/inventory/events",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/inventory/events.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Commands",permalink:"/docs/inventory/commands"},next:{title:"Exports",permalink:"/docs/inventory/exports"}},v=[{value:"Server-side",id:"server-side",children:[{value:"inventory:exitedInventory",id:"inventoryexitedinventory",children:[],level:3},{value:"inventory:fetchOpenInventory",id:"inventoryfetchopeninventory",children:[],level:3},{value:"inventory:createInventory",id:"inventorycreateinventory",children:[],level:3},{value:"inventory:openSecondaryInventory",id:"inventoryopensecondaryinventory",children:[],level:3},{value:"inventory:setInventory",id:"inventorysetinventory",children:[],level:3},{value:"inventory:createSecondaryInventoryTemp",id:"inventorycreatesecondaryinventorytemp",children:[],level:3},{value:"inventory:openSecondaryInventoryTemp",id:"inventoryopensecondaryinventorytemp",children:[],level:3},{value:"inventory:setInventoryTemp",id:"inventorysetinventorytemp",children:[],level:3},{value:"inventory:openPlayerInventory",id:"inventoryopenplayerinventory",children:[],level:3},{value:"inventory:openBuyInventory",id:"inventoryopenbuyinventory",children:[],level:3},{value:"inventory:openSellInventory",id:"inventoryopensellinventory",children:[],level:3},{value:"inventory:openCraftInventory",id:"inventoryopencraftinventory",children:[],level:3}],level:2}],p={toc:v};function c(e){var n=e.components,t=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"events"},"Events"),(0,r.kt)("h2",{id:"server-side"},"Server-side"),(0,r.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"danger")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"All the events which parse the player ",(0,r.kt)("inlineCode",{parentName:"p"},"src")," as an argument below ",(0,r.kt)("strong",{parentName:"p"},"must")," be triggered by the server, this is a safety feature. If you try to trigger such an event from the client-side, it may result in false bans from the anti-cheat system."))),(0,r.kt)("h3",{id:"inventoryexitedinventory"},"inventory:exitedInventory"),(0,r.kt)("p",null,"Triggered when the player has exited their inventory, this event will save inventory state flag the inventory as available. This event may be triggered by either the client or server. The server will override the ",(0,r.kt)("inlineCode",{parentName:"p"},"src")," parameter if triggered by a client."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'AddEventHandler("inventory:exitedInventory", function(src --[[int]], playerDropped --[[bool]])\n-- src: the Id of player which has exited their inventory\n-- playerDropped: a flag indicating whether the player disconnected\nend);\n')),(0,r.kt)("h3",{id:"inventoryfetchopeninventory"},"inventory:fetchOpenInventory"),(0,r.kt)("p",null,"Triggered by the client when the player opens their inventory."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'AddEventHandler("inventory:fetchOpenInventory", function(nearestDropInv --[[string]])\n--- nearestDropInv: the nearest inventory where the player can drop items\nend);\n')),(0,r.kt)("h3",{id:"inventorycreateinventory"},"inventory:createInventory"),(0,r.kt)("p",null,"This event will create a new empty inventory and store it in the database, it will be persistent between sessions."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'TriggerEvent("inventory:createInventory", invName --[[string]], maxRows --[[int]], maxWeight --[[int]], clearInventory --[[bool]]);\n-- invName: the inventory name\n-- maxRows: maximum number of rows\n-- maxWeight: maximum weight\n-- clearInventory?: if the inventory already exists, simply clear it\n')),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"You must ensure that all inventory names are unique, otherwise the database will throw a key error or the cache may overwrite with data from another inventory."))),(0,r.kt)("h3",{id:"inventoryopensecondaryinventory"},"inventory:openSecondaryInventory"),(0,r.kt)("p",null,"This event will open a persistent inventory, and cache it if not already opened before."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'TriggerEvent("inventory:openSecondaryInventory", invName --[[string]], src --[[int]], createIfNotExists --[[bool]], maxRows --[[int]], maxWeight --[[int]]);\n-- invName: the inventory name\n-- src: the player which is opening the inventory\n-- createIfNotExists?: create the inventory if it does not exist, and open it\n-- maxRows?: if creating, set the maximum number of rows\n-- maxWeight?: if creating, set the maximum weight\n')),(0,r.kt)("h3",{id:"inventorysetinventory"},"inventory:setInventory"),(0,r.kt)("p",null,"This event will set the values of a persistent inventory, and create it if it does not exist."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'TriggerEvent("inventory:setInventory", invName --[[string]], maxRows --[[int]], maxWeight --[[int]], weight --[[int]], items --[[table]]);\n-- invName: the inventory name\n-- maxRows: maximum number of rows\n-- maxWeight: maximum weight\n-- weight: current weight level\n-- items: dictionary of indexed items\n')),(0,r.kt)("h3",{id:"inventorycreatesecondaryinventorytemp"},"inventory:createSecondaryInventoryTemp"),(0,r.kt)("p",null,"This event will create a new empty inventory and only cache it, it will ",(0,r.kt)("strong",{parentName:"p"},"not")," be persistent between sessions."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'TriggerEvent("inventory:createSecondaryInventoryTemp", invName --[[string]], maxRows --[[int]], maxWeight --[[int]], weight --[[int]], items --[[table]]);\n-- invName: the inventory name\n-- maxRows: maximum number of rows\n-- maxWeight: maximum weight\n-- weight: current weight level\n-- items: dictionary of indexed items\n')),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"You must ensure that all inventory names are unique, otherwise the database will throw a key error or the cache may overwrite with data from another inventory."))),(0,r.kt)("h3",{id:"inventoryopensecondaryinventorytemp"},"inventory:openSecondaryInventoryTemp"),(0,r.kt)("p",null,"This event will open a temporary inventory, and cache it for the current session only."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'TriggerEvent("inventory:openSecondaryInventoryTemp", invName --[[string]], src --[[int]], createIfNotExists --[[bool]], maxRows --[[int]], maxWeight --[[int]], weight --[[int]], items --[[table]]);\n-- invName: the inventory name\n-- src: the player which is opening the inventory\n-- createIfNotExists?: create the inventory if it does not exist, and open it\n-- maxRows?: if creating, set the maximum number of rows\n-- maxWeight?: if creating, set the maximum weight\n-- weight?: if creating, current weight level\n-- items?: if creating, dictionary of indexed items\n')),(0,r.kt)("h3",{id:"inventorysetinventorytemp"},"inventory:setInventoryTemp"),(0,r.kt)("p",null,"This event will set the values of a temporary inventory."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'TriggerEvent("inventory:setInventoryTemp", invName --[[string]], maxRows --[[int]], maxWeight --[[int]], weight --[[int]], items --[[table]]);\n-- invName: the inventory name\n-- maxRows: maximum number of rows\n-- maxWeight: maximum weight\n-- weight: current weight level\n-- items: dictionary of indexed items\n')),(0,r.kt)("h3",{id:"inventoryopenplayerinventory"},"inventory:openPlayerInventory"),(0,r.kt)("p",null,"This event will open the inventory of another player."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'TriggerEvent("inventory:openPlayerInventory", src --[[int]], target --[[int]]);\n-- src: the player which is opening the other players inventory\n-- target: the target player\n')),(0,r.kt)("h3",{id:"inventoryopenbuyinventory"},"inventory:openBuyInventory"),(0,r.kt)("p",null,"This event will open a special inventory where the character can buy items."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'TriggerEvent("inventory:openBuyInventory", src --[[int]], buyData --[[table]]);\n-- src: target player Id\n-- buyData: dictionary of indexed items\n')),(0,r.kt)("p",null,"The parameter ",(0,r.kt)("inlineCode",{parentName:"p"},"buyData")," is a special inventory, and structured like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua"},'{\n  ["name"] = "buy",\n  ["weight"] = 0.0,\n  ["max_weight"] = 0.0,\n  ["rows"] = 10,\n  ["log"] = "buy-log",\n  ["tax"] = true,\n  ["items"] = {\n    ["0"] = {\n      ["name"] = "pistol",\n      ["label"] = "Pistol",\n      ["weapon"] = true,\n      ["quantity"] = 1,\n      ["weight"] = 12,\n      ["stackable"] = false,\n      ["price"] = 1000\n    }\n  }\n}\n')),(0,r.kt)("p",null,"This inventory name ",(0,r.kt)("strong",{parentName:"p"},"does not")," need to be unique, as it is not cached or stored. "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The item attribute ",(0,r.kt)("inlineCode",{parentName:"li"},"weapon")," will create a serial number for the item when it is purchased, and assign it in item metadata."),(0,r.kt)("li",{parentName:"ul"},"The inventory attribute ",(0,r.kt)("inlineCode",{parentName:"li"},"log")," will create a log for the purchase to the corresponding log name (in this case ",(0,r.kt)("inlineCode",{parentName:"li"},"buy-log"),")."),(0,r.kt)("li",{parentName:"ul"},"The inventory attribute ",(0,r.kt)("inlineCode",{parentName:"li"},"tax")," will add the standard tax rate to each item as assigned in the ",(0,r.kt)("inlineCode",{parentName:"li"},"px_state")," resource.")),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"When naming a log file, ensure it abides by all OS file name restrictions - otherwise your log may not be created."))),(0,r.kt)("h3",{id:"inventoryopensellinventory"},"inventory:openSellInventory"),(0,r.kt)("p",null,"This event will open a special inventory where the character can sell items."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'TriggerEvent("inventory:openSellInventory", src --[[int]], sellData --[[table]]);\n-- src: target player Id\n-- sellData: dictionary of indexed items\n')),(0,r.kt)("p",null,"The parameter ",(0,r.kt)("inlineCode",{parentName:"p"},"sellData")," is a special inventory, and structured like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua"},'{\n  ["name"] = "sell",\n  ["weight"] = 0.0,\n  ["max_weight"] = 0.0,\n  ["rows"] = 10,\n  ["log"] = "sell-log",\n  ["items"] = {\n    ["0"] = {\n      ["name"] = "pistol",\n      ["label"] = "Pistol",\n      ["quantity"] = 1,\n      ["weight"] = 12,\n      ["stackable"] = false,\n      ["price"] = 1000\n    },\n    ["1"] = {\n      ["name"] = "animalpelt",\n      ["label"] = "Animal Pelt",\n      ["quantity"] = 1,\n      ["weight"] = 5,\n      ["stackable"] = false,\n      ["price"] = "50 + VAR",\n      ["priceMethod"] = function(itemData, quantity)\n        return itemData.rarity * 50 * quantity\n      end,\n      ["desc"] = "Sale price is variable on the type of animal pelt provided."\n    }\n  }\n}\n')),(0,r.kt)("p",null,"This inventory name ",(0,r.kt)("strong",{parentName:"p"},"does not")," need to be unique, as it is not cached or stored. "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The inventory attribute ",(0,r.kt)("inlineCode",{parentName:"li"},"log")," will create a log for the purchase to the corresponding log name (in this case ",(0,r.kt)("inlineCode",{parentName:"li"},"sell-log"),")."),(0,r.kt)("li",{parentName:"ul"},"An item may have a variable sell price determined by its metadata. This can be determined by the use of a ",(0,r.kt)("inlineCode",{parentName:"li"},"priceMethod")," function, which takes in parameterized item metadata and returns a price.")),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"When naming a log file, ensure it abides by all OS file name restrictions - otherwise your log may not be created."))),(0,r.kt)("h3",{id:"inventoryopencraftinventory"},"inventory:openCraftInventory"),(0,r.kt)("p",null,"This event will open a special inventory where the character can craft items."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="server/main.lua"',title:'"server/main.lua"'},'TriggerEvent("inventory:openCraftInventory", src --[[int]], craftData --[[table]]);\n-- src: target player Id\n-- craftData: dictionary of indexed items\n')),(0,r.kt)("p",null,"The parameter ",(0,r.kt)("inlineCode",{parentName:"p"},"craftData")," is a special inventory, and structured like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua"},'{\n  ["name"] = "craft",\n  ["weight"] = 0.0,\n  ["max_weight"] = 0.0,\n  ["rows"] = 10,\n  ["items"] = {\n    ["0"] = {\n      ["name"] = "pistol",\n      ["label"] = "Pistol",\n      ["quantity"] = 1,\n      ["weight"] = 12,\n      ["recipe"] = {\n        ["aluminum"] = {\n          label = "Aluminum", quantity = 3\n        },\n        ["steel"] = {\n          label = "Steel", quantity = 1\n        },\n        ["plastic"] = {\n          label = "Plastic", quantity = 2\n        },\n        ["rubber"] = {\n          label = "Rubber", quantity = 1\n        }\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"This inventory name ",(0,r.kt)("strong",{parentName:"p"},"does not")," need to be unique, as it is not cached or stored."))}c.isMDXComponent=!0}}]);